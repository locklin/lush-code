
(libload "blas/mat")
(libload "gnuplot/plot")
(libload "libnum/polynomials")

;; polynomial interpolation to test mat-solve
(defun test-solve ()
  (let* ((ys [0 0 0 1 1 1 0 0 0 0 0])
         (xs (arange -1 1.01 0.2))
         (xys (array-combine* xs ys)) )
    
    ;; interpolate exactly and approximately
    (let* ((c1 (mat-solve! (mat-vander xs) ##ys))
           (c2 (mat-solve! (mat-vander xs 8) ##ys))
           (c3 (mat-solve! (mat-vander xs 6) ##ys))
           (xs (arange -1 1.01 0.01))
           (y1 (poly c1 xs))
           (y2 (poly c2 xs))
           (y3 (poly c3 xs))
           (++ array-combine) )
      (plot (line (++ xs y1))
            (line (++ xs y2))
            (line (++ xs y3)) ))))
      

