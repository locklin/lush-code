#;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
#;;;
#;;; LUSH Lisp Universal Shell
#;;;   Copyright (C) 2002 Leon Bottou, Yann Le Cun, AT&T Corp, NECI.
#;;; Includes parts of TL3:
#;;;   Copyright (C) 1987-1999 Leon Bottou and Neuristique.
#;;; Includes selected parts of SN3.2:
#;;;   Copyright (C) 1991-2001 AT&T Corp.
#;;;
#;;; This program is free software; you can redistribute it and/or modify
#;;; it under the terms of the GNU General Public License as published by
#;;; the Free Software Foundation; either version 2 of the License, or
#;;; (at your option) any later version.
#;;;
#;;; This program is distributed in the hope that it will be useful,
#;;; but WITHOUT ANY WARRANTY; without even the implied warranty of
#;;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#;;; GNU General Public License for more details.
#;;;
#;;; You should have received a copy of the GNU General Public License
#;;; along with this program; if not, write to the Free Software
#;;; Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111, USA
#;;;
#;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

#;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
#;;; $Id: Makefile.in,v 1.3 2002-05-01 15:23:00 leonb Exp $
#;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

@SET_MAKE@
SHELL = @SHELL@
VPATH = @srcdir@
srcdir = @srcdir@
top_srcdir = @top_srcdir@
top_builddir = ..
bindir = ${top_builddir}/bin

OPTS = @OPTS@
DEFS = @DEFS@
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@
host = @host@
CC = @CC@
GCC = @GCC@
CCFLAGS = @CFLAGS@
CXX = @CXX@
CXXFLAGS = @CXXFLAGS@
F77 = @F77@
FFLAGS = @FFLAGS@
LDCC = @LDCC@
CPP = @CPP@
AR = @AR@
MV = @MV@
CP = @CP@
LN_S = @LN_S@
TOUCH = @TOUCH@
RANLIB = @RANLIB@
INSTALL = @INSTALL@
LN_S = @LN_S@
X_LIBS = @X_LIBS@
X_CFLAGS = @X_CFLAGS@
CC_PIC_FLAG = @CC_PIC_FLAG@
CC_EXP_FLAG = @CC_EXP_FLAG@
MAKESO = @MAKESO@
EXEEXT = @EXEEXT@
OBJEXT = @OBJEXT@
SOEXT = @SOEXT@
MAKESO = @MAKESO@

#;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

LUSH=lush

INCS=-I${top_srcdir}/include

CFLAGS=${CCFLAGS} ${DEFS} ${OPTS} ${INCS} ${X_CFLAGS}

OBJS1=allocate.o at.o binary.o calls.o check_func.o \
      classify.o date.o dump.o dz.o eval.o fileio.o \
      fltlib.o function.o graphics.o htable.o \
      idx1.o idx2.o idx3.o idx4.o index.o io.o \
      lisp_c.o main.o nan.o oostruct.o ps_driver.o \
      storage.o string.o symbol.o toplevel.o user.o

@UNIX_YES@OBJS3=unix.o
@UNIX_YES@@X_YES@OBJS2=x11_driver.o
@WIN32_YES@OBJS3=win32.o win_driver.o
@BFD_YES@OBJS4=dldbfd.o

OBJS=${OBJS1} ${OBJS2} ${OBJS3} ${OBJS4}

all: ${LUSH}

lush: ${OBJS}
	${LDCC} ${CFLAGS} ${CC_EXP_FLAG} -o $@ ${OBJS} ${X_LIBS} ${LIBS}

install: all FORCE
	@test -d ${bindir} || mkdir ${bindir}
	@test -r ${bindir}/lush~3 && ${MV} ${bindir}/lush~3 ${bindir}/lush~4 || true
	@test -r ${bindir}/lush~2 && ${MV} ${bindir}/lush~2 ${bindir}/lush~3 || true
	@test -r ${bindir}/lush~1 && ${MV} ${bindir}/lush~1 ${bindir}/lush~2 || true
	@test -r ${bindir}/lush && ${MV} ${bindir}/lush   ${bindir}/lush~1 || true
	${INSTALL} -m 755 lush ${bindir}

depend: FORCE
	-@test x${GCC} = xyes && ${MAKE} depend-gcc

depend-gcc: 
	@echo "Computing dependencies." 
	@echo '### DEPENDENCIES' > Makefile.dep
	@${CC} -MM ${CFLAGS} `echo ${OBJS} | sed -e 's:\.o:.c:g'` >> Makefile.dep
	@echo "Updating Makefile." ;\
	 ( sed -e '/^### DEPENDENCIES$$/,$$d' Makefile;\
	   cat Makefile.dep ) > Makefile.new ;\
	 ${MV} Makefile.new Makefile
	@if test -w Makefile.in ; then echo "Updating Makefile.in." ;\
	 ( sed -e '/^### DEPENDENCIES$$/,$$d' Makefile.in;\
	   cat Makefile.dep ) > Makefile.new ;\
	 ${MV} Makefile.new Makefile.in ; fi ; true

clean: FORCE
	-${RM} 2>/dev/null Makefile.dep 
	-${RM} 2>/dev/null ${LUSH}
	-${RM} 2>/dev/null ${OBJS}

distclean: clean FORCE
	-${RM} 2>/dev/null Makefile

FORCE:

.PHONY: FORCE

.SUFFIXES: .c

.c.o:
	${CC} ${CFLAGS} -c $<

### DEPENDENCIES
allocate.o: allocate.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
at.o: at.c ../include/header.h ../include/define.h ../include/config.h \
  ../include/fltlib.h ../include/check_func.h
binary.o: binary.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
calls.o: calls.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
check_func.o: check_func.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h \
  ../include/idxmac.h ../include/idxops.h
classify.o: classify.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
date.o: date.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
dump.o: dump.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
dz.o: dz.c ../include/header.h ../include/define.h ../include/config.h \
  ../include/fltlib.h ../include/check_func.h
eval.o: eval.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
fileio.o: fileio.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
fltlib.o: fltlib.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
function.o: function.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
graphics.o: graphics.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h \
  ../include/graphics.h
htable.o: htable.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
idx1.o: idx1.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h \
  ../include/idxmac.h ../include/idxops.h ../include/idx.h
idx2.o: idx2.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h \
  ../include/idxmac.h ../include/idxops.h ../include/idx.h
idx3.o: idx3.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h \
  ../include/idxmac.h ../include/idxops.h ../include/idx.h
idx4.o: idx4.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h \
  ../include/idxmac.h ../include/idxops.h ../include/idx.h
index.o: index.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
io.o: io.c ../include/header.h ../include/define.h ../include/config.h \
  ../include/fltlib.h ../include/check_func.h
lisp_c.o: lisp_c.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
main.o: main.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
nan.o: nan.c ../include/header.h ../include/define.h ../include/config.h \
  ../include/fltlib.h ../include/check_func.h
oostruct.o: oostruct.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
ps_driver.o: ps_driver.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h \
  ../include/graphics.h
storage.o: storage.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
string.o: string.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
symbol.o: symbol.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
toplevel.o: toplevel.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
user.o: user.c ../include/header.h ../include/define.h \
  ../include/config.h ../include/fltlib.h ../include/check_func.h
x11_driver.o: x11_driver.c ../include/config.h ../include/header.h \
  ../include/define.h ../include/fltlib.h ../include/check_func.h \
  ../include/graphics.h
unix.o: unix.c ../include/config.h ../include/header.h \
  ../include/define.h ../include/fltlib.h ../include/check_func.h \
  ../include/autoconf.h
dldbfd.o: dldbfd.c ../include/dldbfd.h
