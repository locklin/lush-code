(libload "gsl/aux_globalvar")
(libload "gsl/aux_structure")
(libload "gsl/interpolation")

;; synthesize 10 points
(setq x (double-matrix 10))
(setq y (double-matrix 10))
(for (i 0 9) 
     (let ((a (+ i (* 0.5 (sin i))))
	   (b (+ i (cos (* i i)))))
       (x i a)
       (y i b)
       ()))

;; use cspline method
(setq acc (gsl_interp_accel_alloc ))
(setq spline (gsl_spline_alloc  (var_gsl_interp_cspline) 10))
(gsl_spline_init spline  (idx-ptr x) (idx-ptr y)  10)

;; evaluation
(setq start_x 0)
(setq end_x (+ 9 (* 0.5 (sin 9.0))))

(setq x_list ())
(setq y_list ())
(for (xi start_x (- end_x 0.01) 0.01) 
     (let ((y (gsl_spline_eval  spline  xi  acc)))
       (setq x_list (cons xi x_list))
       (setq y_list (cons y  y_list))
       ()))

(gsl_spline_free   spline)
(gsl_interp_accel_free  acc)

(new-window)
(graph-xy x_list y_list "ugly")
